# æ•™ä¼šç­¾åˆ°ç®¡ç†ç³»ç»Ÿ v4.1

å¤šæ•™ä¼šç­¾åˆ°ç³»ç»Ÿï¼Œæ”¯æŒæ•™ä¼šç®¡ç†ã€å‘˜å·¥ç®¡ç†ã€ç­¾åˆ°ç»Ÿè®¡å’ŒäºŒç»´ç ç”Ÿæˆã€‚

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### âœ¨ æ–°å¢åŠŸèƒ½ï¼ˆv4.1å‡çº§ï¼‰

#### 1ï¸âƒ£ å¤šæ•™ä¼šç®¡ç†
- åˆ›å»ºå’Œç®¡ç†å¤šä¸ªæ•™ä¼š
- ä¸ºæ¯ä¸ªæ•™ä¼šåˆ†é…ç‹¬ç«‹ç®¡ç†å‘˜
- ä¸€ä¸ªç®¡ç†å‘˜å¯ç®¡ç†å¤šä¸ªæ•™ä¼š
- æ•™ä¼šä¹‹é—´æ•°æ®å®Œå…¨éš”ç¦»

#### 2ï¸âƒ£ äººå‘˜ç®¡ç†å¢å¼º
- âœï¸ ç¼–è¾‘å‘˜å·¥ä¿¡æ¯ï¼ˆå§“åã€æ€§åˆ«ã€å¹´é¾„ã€ç”µè¯ã€åœ°å€ï¼‰
- ğŸ—‘ï¸ åˆ é™¤å‘˜å·¥è®°å½•
- â• å¿«é€Ÿæ–°å¢å‘˜å·¥
- ğŸ” æœç´¢åŠŸèƒ½ï¼ˆæŒ‰å§“åæˆ–ç”µè¯ï¼‰
- ğŸ“Š å‘˜å·¥åˆ—è¡¨åˆ†é¡µæ˜¾ç¤º
- ğŸ“¥ å¯¼å‡ºä¸º CSV/Excel æ ¼å¼

#### 3ï¸âƒ£ ç­¾åˆ°æ•°æ®ç»Ÿè®¡
- 7å¤©ç­¾åˆ°è¶‹åŠ¿æ›²çº¿å›¾ï¼ˆçœŸå®æ•°æ®ï¼‰
- ä»Šæ—¥ç­¾åˆ°/ç¼ºå¸­ç»Ÿè®¡
- æŒ‰æ•™ä¼šç‹¬ç«‹ç»Ÿè®¡
- å®æ—¶æ•°æ®æ›´æ–°

#### 4ï¸âƒ£ æ•™ä¼šäºŒç»´ç 
- ä¸ºæ¯ä¸ªæ•™ä¼šç”Ÿæˆç‹¬æœ‰ç­¾åˆ°äºŒç»´ç 
- å‘˜å·¥æ‰«ç ç›´æ¥è¿›å…¥ç­¾åˆ°é¡µé¢
- è‡ªåŠ¨è¯†åˆ«æ•™ä¼šä»£ç 
- æ˜“äºåˆ†äº«å’Œæ‰“å°

### ğŸ“± ç°æœ‰åŠŸèƒ½

- å‘˜å·¥ç­¾åˆ°ç™»è®°ï¼ˆäºŒç»´ç /æ‰‹æœº/ç”µè„‘ï¼‰
- å‘˜å·¥æ³¨å†Œè‡ªåŠ©
- æŒ‰æ•™ä¼šçš„ç‹¬ç«‹ç­¾åˆ°é“¾æ¥
- çµæ´»çš„èº«ä»½éªŒè¯ï¼ˆæ”¯æŒæŒ‰åå­—æˆ–ç”µè¯ï¼‰

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å‰ç«¯ (Vue 3 + Element Plus)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Dashboard | å‘˜å·¥ç®¡ç† | æ•™ä¼šç®¡ç† | ç­¾åˆ°é¡µ | æ³¨å†Œé¡µ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ HTTP/REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      åç«¯ (Node.js + Express + MySQL)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è®¤è¯ | æ•™ä¼šç®¡ç† | å‘˜å·¥ç®¡ç† | ç­¾åˆ°ç»Ÿè®¡ | äºŒç»´ç     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ SQL
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MySQL æ•°æ®åº“                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  companies | admins | employees | attendance       â”‚
â”‚  church_admins (å¤šå¯¹å¤šå…³ç³»)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
- Node.js 14+
- MySQL 5.7+
- ç°ä»£æµè§ˆå™¨

### 3åˆ†é’Ÿå¯åŠ¨

```bash
# ç»ˆç«¯1ï¼šåç«¯
cd server
npm install
node scripts/migrate_church_system.js
node scripts/init_test_data.js
node app.js

# ç»ˆç«¯2ï¼šå‰ç«¯
cd client
npm install
npm run dev
```

è®¿é—® `http://localhost:5173/admin/login`

**æµ‹è¯•è´¦æˆ·**ï¼š
- ç”¨æˆ·å: `admin`
- å¯†ç : `admin123`

è¯¦è§ [QUICK_START.md](QUICK_START.md)

## ğŸ“ é¡¹ç›®ç»“æ„

```
attendance-project-v4/
â”œâ”€â”€ ğŸ“‚ server/                          # åç«¯
â”‚   â”œâ”€â”€ app.js                          # ä¸»åº”ç”¨ (API)
â”‚   â”œâ”€â”€ db.js                           # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ ğŸ“‚ scripts/
â”‚   â”‚   â”œâ”€â”€ migrate_church_system.js   # æ•°æ®åº“è¿ç§» [æ–°]
â”‚   â”‚   â”œâ”€â”€ init_test_data.js          # æµ‹è¯•æ•°æ® [æ–°]
â”‚   â”‚   â”œâ”€â”€ test_db.js
â”‚   â”‚   â”œâ”€â”€ gen_hash.js
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ ğŸ“‚ sql/
â”‚   â”‚   â””â”€â”€ init.sql
â”‚   â””â”€â”€ .gitignore
â”‚
â”œâ”€â”€ ğŸ“‚ client/                          # å‰ç«¯
â”‚   â”œâ”€â”€ ğŸ“‚ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ ChurchManagement.vue   # æ•™ä¼šç®¡ç† [æ–°]
â”‚   â”‚   â”‚   â”œâ”€â”€ EmployeeList.vue        # å‘˜å·¥åˆ—è¡¨ [æ”¹]
â”‚   â”‚   â”‚   â”œâ”€â”€ EmployeeForm.vue        # å‘˜å·¥è¡¨å• [æ”¹]
â”‚   â”‚   â”‚   â”œâ”€â”€ StatsCard.vue
â”‚   â”‚   â”‚   â””â”€â”€ SignTrendChart.vue
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ views/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ admin/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.vue       # ç®¡ç†å° [æ”¹]
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AdminLogin.vue      # ç™»å½• [æ”¹]
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“‚ public/
â”‚   â”‚   â”‚       â”œâ”€â”€ Sign.vue            # ç­¾åˆ°é¡µ
â”‚   â”‚   â”‚       â””â”€â”€ Register.vue        # æ³¨å†Œé¡µ
â”‚   â”‚   â”œâ”€â”€ router/index.js             # è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ api.js                      # API å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ App.vue
â”‚   â”‚   â””â”€â”€ main.js
â”‚   â”œâ”€â”€ package.json                    # ä¾èµ– [æ”¹]
â”‚   â”œâ”€â”€ vite.config.js
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ .gitignore
â”‚
â”œâ”€â”€ ğŸ“– æ–‡æ¡£/
â”‚   â”œâ”€â”€ QUICK_START.md                  # å¿«é€Ÿå¯åŠ¨ [æ–°]
â”‚   â”œâ”€â”€ UPGRADE_GUIDE.md                # å‡çº§æŒ‡å— [æ–°]
â”‚   â”œâ”€â”€ IMPLEMENTATION_SUMMARY.md       # å®ç°æ€»ç»“ [æ–°]
â”‚   â”œâ”€â”€ COMMANDS.md                     # å‘½ä»¤é€ŸæŸ¥ [æ–°]
â”‚   â””â”€â”€ SECURITY.md
â”‚
â”œâ”€â”€ ğŸ”§ è„šæœ¬/
â”‚   â”œâ”€â”€ check_completion.sh             # æ£€æŸ¥è„šæœ¬ [æ–°]
â”‚   â””â”€â”€ check_completion.bat            # Windowsç‰ˆ [æ–°]
â”‚
â”œâ”€â”€ .gitignore
â””â”€â”€ README.md                           # æœ¬æ–‡ä»¶

[æ–°] = æ–°å¢æ–‡ä»¶
[æ”¹] = ä¿®æ”¹æ–‡ä»¶
```

## ğŸ“Š API æ ¸å¿ƒç«¯ç‚¹

### æ•™ä¼šç®¡ç†
```
GET    /api/admin/churches                     # è·å–æ‰€æœ‰æ•™ä¼š
POST   /api/admin/churches                     # åˆ›å»ºæ•™ä¼š
POST   /api/admin/switch-church                # åˆ‡æ¢æ•™ä¼š
POST   /api/admin/churches/:churchId/admins    # åˆ†é…ç®¡ç†å‘˜
```

### å‘˜å·¥ç®¡ç†
```
GET    /api/admin/employees                    # è·å–å‘˜å·¥åˆ—è¡¨
POST   /api/admin/employees                    # æ–°å¢å‘˜å·¥
PUT    /api/admin/employees/:id                # ç¼–è¾‘å‘˜å·¥
DELETE /api/admin/employees/:id                # åˆ é™¤å‘˜å·¥
```

### ç­¾åˆ°ç»Ÿè®¡
```
GET    /api/admin/today                        # ä»Šæ—¥ç­¾åˆ°æ•°æ®
GET    /api/admin/stats                        # 7å¤©ç»Ÿè®¡æ•°æ®
GET    /api/admin/qrcode                       # è·å–äºŒç»´ç 
```

### å…¬å¼€ç«¯ç‚¹
```
POST   /api/public/sign                        # ç­¾åˆ°
POST   /api/public/register                    # å‘˜å·¥æ³¨å†Œ
GET    /api/public/company                     # è·å–æ•™ä¼šä¿¡æ¯
GET    /api/public/companies                   # æœç´¢æ•™ä¼š
```

è¯¦è§ [UPGRADE_GUIDE.md](UPGRADE_GUIDE.md) çš„APIéƒ¨åˆ†

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨ç»“æ„

```sql
-- æ•™ä¼šè¡¨
CREATE TABLE companies (
  id INT PRIMARY KEY,
  name VARCHAR(100),
  code VARCHAR(50) UNIQUE,
  created_by INT,                   -- åˆ›å»ºäºº
  created_at TIMESTAMP
);

-- ç®¡ç†å‘˜è¡¨
CREATE TABLE admins (
  id INT PRIMARY KEY,
  username VARCHAR(50),
  password VARCHAR(255),
  company_id INT,
  church_id INT
);

-- ç®¡ç†å‘˜-æ•™ä¼šæ˜ å°„è¡¨ï¼ˆæ”¯æŒä¸€å¯¹å¤šï¼‰
CREATE TABLE church_admins (
  id INT PRIMARY KEY,
  admin_id INT NOT NULL,
  church_id INT NOT NULL,
  role VARCHAR(50),                 -- owner/manager
  created_at TIMESTAMP,
  UNIQUE(admin_id, church_id)
);

-- å‘˜å·¥è¡¨
CREATE TABLE employees (
  id INT PRIMARY KEY,
  company_id INT,
  name VARCHAR(50),
  gender VARCHAR(10),
  age INT,
  phone VARCHAR(20),
  address VARCHAR(255)
);

-- ç­¾åˆ°è¡¨
CREATE TABLE attendance (
  id INT PRIMARY KEY,
  employee_id INT,
  company_id INT,
  sign_date DATE,
  sign_time DATETIME,
  sign_ip VARCHAR(50),
  UNIQUE(employee_id, sign_date)
);
```

æ•°æ®éš”ç¦»é€šè¿‡ `company_id` å®ç°ã€‚

## ğŸ” å®‰å…¨ç‰¹æ€§

- JWT è®¤è¯
- å¯†ç  bcrypt åŠ å¯†
- æ•™ä¼šæ•°æ®å®Œå…¨éš”ç¦»
- æƒé™éªŒè¯ï¼ˆowner/managerï¼‰
- SQLæ³¨å…¥é˜²æŠ¤ï¼ˆå‚æ•°åŒ–æŸ¥è¯¢ï¼‰

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

- æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- åˆ†é¡µæŸ¥è¯¢
- JWT Tokenç¼“å­˜
- å¼‚æ­¥APIè°ƒç”¨

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œå®Œæ•´æ€§æ£€æŸ¥ï¼ˆWindowsï¼‰
check_completion.bat

# æˆ– Linux/Mac
bash check_completion.sh

# æµ‹è¯•æ•°æ®åº“è¿æ¥
cd server && node scripts/test_db.js

# åˆå§‹åŒ–æµ‹è¯•æ•°æ®
node scripts/init_test_data.js
```

## ğŸ“š æ–‡æ¡£ç´¢å¼•

- **[QUICK_START.md](QUICK_START.md)** - å¿«é€Ÿå¯åŠ¨æŒ‡å—ï¼Œ5åˆ†é’Ÿä¸Šæ‰‹
- **[UPGRADE_GUIDE.md](UPGRADE_GUIDE.md)** - è¯¦ç»†åŠŸèƒ½è¯´æ˜å’ŒAPIæ–‡æ¡£
- **[IMPLEMENTATION_SUMMARY.md](IMPLEMENTATION_SUMMARY.md)** - æŠ€æœ¯å®ç°ç»†èŠ‚
- **[COMMANDS.md](COMMANDS.md)** - å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨

## ğŸ“ å­¦ä¹ èµ„æº

- [Vue 3 å®˜æ–¹æ–‡æ¡£](https://vuejs.org/)
- [Express.js ä¸­æ–‡æ–‡æ¡£](http://www.expressjs.com.cn/)
- [Element Plus ç»„ä»¶åº“](https://element-plus.org/zh-CN/)
- [MySQL å®˜æ–¹æ–‡æ¡£](https://dev.mysql.com/doc/)

## ğŸ› å¸¸è§é—®é¢˜

**Q: ç™»å½•åçœ‹ä¸åˆ°æ•™ä¼šï¼Ÿ**
A: æ£€æŸ¥ `church_admins` è¡¨ï¼Œç¡®ä¿ç®¡ç†å‘˜æœ‰å¯¹åº”çš„æ•™ä¼šè®°å½•ã€‚

**Q: å‘˜å·¥åˆ—è¡¨ä¸ºç©ºï¼Ÿ**
A: ç¡®è®¤å·²åˆ‡æ¢åˆ°æ­£ç¡®çš„æ•™ä¼šï¼Œæ£€æŸ¥å‘˜å·¥çš„ `company_id`ã€‚

**Q: äºŒç»´ç æ— æ³•ç”Ÿæˆï¼Ÿ**
A: æ£€æŸ¥æ˜¯å¦å·²å®‰è£… `qrcode` npmåŒ…ï¼š`npm install qrcode`

**Q: ç­¾åˆ°æ•°æ®ä¸å‡†ç¡®ï¼Ÿ**
A: æ£€æŸ¥æ•°æ®åº“ä¸­çš„ `attendance` è¡¨ï¼Œç¡®ä¿æ•°æ®å®Œæ•´ã€‚

æ›´å¤šé—®é¢˜è§ [QUICK_START.md#å¸¸è§é—®é¢˜å¿«é€Ÿè§£å†³](QUICK_START.md)

## ğŸš¢ éƒ¨ç½²å»ºè®®

### å¼€å‘ç¯å¢ƒ
```bash
npm run dev      # å‰ç«¯
node app.js      # åç«¯
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
npm run build    # æ„å»ºå‰ç«¯
# ä½¿ç”¨ PM2, Docker æˆ–å…¶ä»–éƒ¨ç½²æ–¹æ¡ˆ
```

è¯¦è§ [QUICK_START.md#ç”Ÿäº§éƒ¨ç½²å»ºè®®](QUICK_START.md)

## ğŸ“ å˜æ›´æ—¥å¿—

### v4.1 (2026-02-02) ğŸ†•
- âœ¨ æ·»åŠ å¤šæ•™ä¼šç®¡ç†åŠŸèƒ½
- âœ¨ æ•™ä¼šç®¡ç†å‘˜åˆ†é…ç³»ç»Ÿ
- âœ¨ ç­¾åˆ°äºŒç»´ç ç”Ÿæˆ
- âœ¨ å‘˜å·¥ç¼–è¾‘/åˆ é™¤åŠŸèƒ½
- ğŸ› ä¿®å¤stats APIé‡å¤é—®é¢˜
- ğŸ“š å®Œæ•´çš„æ–‡æ¡£å’ŒæŒ‡å—

### v4.0
- åŸºç¡€ç­¾åˆ°ç³»ç»Ÿ
- å‘˜å·¥ç®¡ç†
- ç­¾åˆ°ç»Ÿè®¡
- äºŒç»´ç è¯†åˆ«

## ğŸ“ æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜ï¼Ÿ

1. æŸ¥çœ‹ç›¸å…³æ–‡æ¡£
2. æ£€æŸ¥é”™è¯¯æ—¥å¿—
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°
4. é˜…è¯»ä»£ç æ³¨é‡Š

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…å’Œä½¿ç”¨è€…çš„æ”¯æŒï¼

---

**å½“å‰ç‰ˆæœ¬**: v4.1  
**æœ€åæ›´æ–°**: 2026-02-02  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª

