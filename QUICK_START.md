# å¿«é€Ÿå¯åŠ¨æŒ‡å—

æœ¬é¡¹ç›®å·²å‡çº§æ”¯æŒå¤šæ•™ä¼šç­¾åˆ°ç®¡ç†ç³»ç»Ÿã€‚ä»¥ä¸‹æ­¥éª¤å°†å¸®åŠ©æ‚¨å¿«é€Ÿå¯åŠ¨ç³»ç»Ÿã€‚

## ç³»ç»Ÿè¦æ±‚

- Node.js 14+ 
- MySQL 5.7+
- ç°ä»£æµè§ˆå™¨ï¼ˆChromeã€Firefoxã€Safariç­‰ï¼‰

## ä¸€é”®å¯åŠ¨æµç¨‹

### 1. å‡†å¤‡æ•°æ®åº“

ç¡®ä¿MySQLæœåŠ¡è¿è¡Œï¼Œå¹¶ä¸”æ•°æ®åº“è¿æ¥ä¿¡æ¯æ­£ç¡®é…ç½®åœ¨ `server/db.js` ä¸­ã€‚

### 2. å®‰è£…ä¾èµ–å¹¶è¿è¡Œè¿ç§»

```bash
# è¿›å…¥é¡¹ç›®æ ¹ç›®å½•

# å®‰è£…åç«¯ä¾èµ–
cd server
npm install

# è¿è¡Œæ•°æ®åº“è¿ç§»
node scripts/migrate_church_system.js

# åˆå§‹åŒ–æµ‹è¯•æ•°æ®ï¼ˆå¯é€‰ï¼‰
node scripts/init_test_data.js

# å¯åŠ¨åç«¯æœåŠ¡
node app.js
```

åœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­ï¼š

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd client
npm install

# å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡
npm run dev
```

### 3. è®¿é—®ç³»ç»Ÿ

æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5173/admin/login`

**æµ‹è¯•è´¦æˆ·**ï¼ˆå¦‚æœè¿è¡Œäº†åˆå§‹åŒ–è„šæœ¬ï¼‰ï¼š
- ç”¨æˆ·åï¼šadmin
- å¯†ç ï¼šadmin123

## åŠŸèƒ½éªŒè¯æ¸…å•

ä½¿ç”¨ä»¥ä¸‹æ£€æŸ¥æ¸…å•éªŒè¯ç³»ç»ŸåŠŸèƒ½æ˜¯å¦æ­£å¸¸ï¼š

### â˜ åŸºç¡€åŠŸèƒ½
- [ ] ç®¡ç†å‘˜èƒ½æ­£å¸¸ç™»å½•
- [ ] ç™»å½•åèƒ½çœ‹åˆ°Dashboard
- [ ] é¡µé¢èƒ½æ­£ç¡®åŠ è½½

### â˜ æ•™ä¼šç®¡ç†
- [ ] æ•™ä¼šé€‰æ‹©å™¨æ˜¾ç¤ºå¤šä¸ªæ•™ä¼š
- [ ] å¯ä»¥åˆ‡æ¢æ•™ä¼š
- [ ] åˆ‡æ¢æ•™ä¼šåæ•°æ®æ­£ç¡®æ›´æ–°
- [ ] å¯ä»¥åˆ›å»ºæ–°æ•™ä¼š
- [ ] å¯ä»¥ä¸ºæ•™ä¼šåˆ†é…ç®¡ç†å‘˜

### â˜ å‘˜å·¥ç®¡ç†
- [ ] å‘˜å·¥åˆ—è¡¨æ˜¾ç¤ºå½“å‰æ•™ä¼šçš„å‘˜å·¥
- [ ] å¯ä»¥æœç´¢å‘˜å·¥ï¼ˆæŒ‰å§“åæˆ–æ‰‹æœºå·ï¼‰
- [ ] å¯ä»¥æ–°å¢å‘˜å·¥
- [ ] å¯ä»¥ç¼–è¾‘å‘˜å·¥ä¿¡æ¯
- [ ] å¯ä»¥åˆ é™¤å‘˜å·¥
- [ ] å‘˜å·¥å¯¼å‡ºåŠŸèƒ½ï¼ˆCSV/Excelï¼‰

### â˜ ç­¾åˆ°åŠŸèƒ½
- [ ] ä»Šæ—¥ç­¾åˆ°åˆ—è¡¨æ˜¾ç¤ºæ­£ç¡®
- [ ] ç»Ÿè®¡å¡ç‰‡æ˜¾ç¤ºæ­£ç¡®çš„äººæ•°
- [ ] èƒ½ç”Ÿæˆç­¾åˆ°äºŒç»´ç 
- [ ] 7å¤©è¶‹åŠ¿å›¾æ˜¾ç¤ºæ­£ç¡®æ•°æ®

### â˜ æ•°æ®éš”ç¦»
- [ ] åˆ‡æ¢æ•™ä¼šAå’ŒBï¼Œå‘˜å·¥åˆ—è¡¨ä¸åŒ
- [ ] åˆ‡æ¢æ•™ä¼šAå’ŒBï¼Œç­¾åˆ°æ•°æ®ä¸åŒ
- [ ] æ¯ä¸ªæ•™ä¼šæœ‰ç‹¬ç«‹çš„äºŒç»´ç 

## é¡¹ç›®ç»“æ„

```
attendance-project-v4/
â”œâ”€â”€ client/                      # å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/          # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ChurchManagement.vue    # æ•™ä¼šç®¡ç†ï¼ˆæ–°ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ EmployeeList.vue        # å‘˜å·¥åˆ—è¡¨ï¼ˆæ›´æ–°ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ EmployeeForm.vue        # å‘˜å·¥è¡¨å•ï¼ˆæ›´æ–°ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ StatsCard.vue           # ç»Ÿè®¡å¡ç‰‡
â”‚   â”‚   â”‚   â””â”€â”€ SignTrendChart.vue      # è¶‹åŠ¿å›¾
â”‚   â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â”‚   â”œâ”€â”€ admin/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.vue       # ç®¡ç†å‘˜ä»ªè¡¨æ¿ï¼ˆæ›´æ–°ï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AdminLogin.vue      # ç™»å½•é¡µï¼ˆæ›´æ–°ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ public/
â”‚   â”‚   â”‚       â”œâ”€â”€ Sign.vue            # ç­¾åˆ°é¡µ
â”‚   â”‚   â”‚       â””â”€â”€ Register.vue        # æ³¨å†Œé¡µ
â”‚   â”‚   â”œâ”€â”€ router/index.js      # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ api.js               # APIå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ App.vue
â”‚   â”‚   â””â”€â”€ main.js
â”‚   â”œâ”€â”€ package.json             # ä¾èµ–é…ç½®ï¼ˆæ›´æ–°ï¼‰
â”‚   â””â”€â”€ vite.config.js
â”‚
â”œâ”€â”€ server/                      # åç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ app.js                   # ä¸»åº”ç”¨ï¼ˆæ›´æ–°ï¼‰
â”‚   â”œâ”€â”€ db.js                    # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ scripts/
â”‚   â”‚   â”œâ”€â”€ migrate_church_system.js   # è¿ç§»è„šæœ¬ï¼ˆæ–°ï¼‰
â”‚   â”‚   â”œâ”€â”€ init_test_data.js          # æµ‹è¯•æ•°æ®åˆå§‹åŒ–ï¼ˆæ–°ï¼‰
â”‚   â”‚   â”œâ”€â”€ add_columns.js
â”‚   â”‚   â”œâ”€â”€ check_admin_record.js
â”‚   â”‚   â”œâ”€â”€ gen_hash.js
â”‚   â”‚   â””â”€â”€ ...å…¶ä»–è„šæœ¬
â”‚   â””â”€â”€ sql/
â”‚       â””â”€â”€ init.sql             # SQLåˆå§‹åŒ–è„šæœ¬
â”‚
â”œâ”€â”€ UPGRADE_GUIDE.md             # è¯¦ç»†å‡çº§æ–‡æ¡£ï¼ˆæ–°ï¼‰
â”œâ”€â”€ QUICK_START.md               # æœ¬æ–‡ä»¶
â””â”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
```

## API æ ¸å¿ƒç«¯ç‚¹

### æ•™ä¼šç›¸å…³
- `GET /api/admin/churches` - è·å–ç®¡ç†å‘˜çš„æ‰€æœ‰æ•™ä¼š
- `POST /api/admin/switch-church` - åˆ‡æ¢æ•™ä¼š
- `POST /api/admin/churches` - åˆ›å»ºæ•™ä¼š
- `POST /api/admin/churches/:churchId/admins` - åˆ†é…ç®¡ç†å‘˜

### å‘˜å·¥ç›¸å…³
- `GET /api/admin/employees` - è·å–å‘˜å·¥åˆ—è¡¨
- `POST /api/admin/employees` - æ–°å¢å‘˜å·¥
- `PUT /api/admin/employees/:id` - æ›´æ–°å‘˜å·¥
- `DELETE /api/admin/employees/:id` - åˆ é™¤å‘˜å·¥

### ç­¾åˆ°ç›¸å…³
- `GET /api/admin/today` - ä»Šæ—¥ç­¾åˆ°æ•°æ®
- `GET /api/admin/stats` - 7å¤©ç»Ÿè®¡æ•°æ®
- `GET /api/admin/qrcode` - è·å–ç­¾åˆ°äºŒç»´ç 

## å¸¸è§é—®é¢˜å¿«é€Ÿè§£å†³

### é—®é¢˜ï¼šè¿ç§»è„šæœ¬è¿è¡Œå¤±è´¥
**è§£å†³**ï¼šæ£€æŸ¥MySQLè¿æ¥ï¼Œè¿è¡Œå‰ç¡®ä¿ï¼š
```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
node scripts/test_db.js
```

### é—®é¢˜ï¼šç™»å½•åçœ‹ä¸åˆ°æ•™ä¼š
**è§£å†³**ï¼šç¡®ä¿ç®¡ç†å‘˜å·²åœ¨ `church_admins` è¡¨ä¸­æœ‰è®°å½•ã€‚å¦‚æœªåˆå§‹åŒ–ï¼Œæ‰‹åŠ¨æ·»åŠ ï¼š
```sql
-- å‡è®¾admin_id=1, church_id=1
INSERT INTO church_admins (admin_id, church_id, role) 
VALUES (1, 1, 'owner');
```

### é—®é¢˜ï¼šå‰ç«¯è¯·æ±‚å¤±è´¥
**æ£€æŸ¥**ï¼š
1. åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œåœ¨ `localhost:3000`
2. æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰CORSé”™è¯¯
3. ç™»å½•tokenæ˜¯å¦æœ‰æ•ˆ

### é—®é¢˜ï¼šç­¾åˆ°äºŒç»´ç æ— æ³•ç”Ÿæˆ
**æ£€æŸ¥**ï¼š
1. `qrcode` npmåŒ…æ˜¯å¦å·²å®‰è£…
2. æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰JSé”™è¯¯
3. `/api/admin/qrcode` APIæ˜¯å¦è¿”å›æ­£ç¡®æ•°æ®

## å¼€å‘å»ºè®®

### æ·»åŠ æ–°åŠŸèƒ½æ­¥éª¤
1. åç«¯ï¼šåœ¨ `server/app.js` ä¸­æ·»åŠ æ–°APIç«¯ç‚¹
2. å‰ç«¯ï¼šåœ¨ç»„ä»¶ä¸­è°ƒç”¨APIï¼Œæ›´æ–°UI
3. æµ‹è¯•ï¼šä½¿ç”¨Postmanæˆ–å¼€å‘è€…å·¥å…·æµ‹è¯•API
4. è¿ç§»ï¼šå¦‚éœ€æ”¹è¡¨ç»“æ„ï¼Œæ›´æ–°è¿ç§»è„šæœ¬

### è°ƒè¯•æŠ€å·§
- åç«¯ï¼šå¯ç”¨ `console.error()` å’Œ `console.log()` æŸ¥çœ‹æ—¥å¿—
- å‰ç«¯ï¼šä½¿ç”¨Vue DevToolså’Œæµè§ˆå™¨DevTools
- APIï¼šä½¿ç”¨PostmanéªŒè¯ç«¯ç‚¹

## æ€§èƒ½ä¼˜åŒ–

- å·²ä¸º `employees` å’Œ `attendance` è¡¨æ·»åŠ ç´¢å¼•
- ä½¿ç”¨åˆ†é¡µè·å–å‘˜å·¥åˆ—è¡¨
- å‰ç«¯ä½¿ç”¨element-plus Tableçš„è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¯é€‰ï¼‰

## å¤‡ä»½å’Œæ¢å¤

### æ•°æ®åº“å¤‡ä»½
```bash
mysqldump -h 139.196.44.6 -u church_user -p church_db > backup.sql
```

### æ•°æ®åº“æ¢å¤
```bash
mysql -h 139.196.44.6 -u church_user -p church_db < backup.sql
```

## ç”Ÿäº§éƒ¨ç½²å»ºè®®

1. **ç¯å¢ƒå˜é‡**ï¼šä½¿ç”¨ `.env` æ–‡ä»¶ç®¡ç†æ•æ„Ÿä¿¡æ¯
2. **æ—¥å¿—**ï¼šé…ç½®æ—¥å¿—ç³»ç»Ÿè®°å½•æ‰€æœ‰æ“ä½œ
3. **å®‰å…¨**ï¼š
   - æ›´æ¢é»˜è®¤å¯†é’¥
   - å¯ç”¨HTTPS
   - æ·»åŠ ç‡é™åˆ¶é˜²æ­¢æš´åŠ›æ”»å‡»
4. **ç›‘æ§**ï¼šè®¾ç½®æ€§èƒ½ç›‘æ§å’Œå‘Šè­¦
5. **å¤‡ä»½**ï¼šå®šæœŸå¤‡ä»½æ•°æ®åº“

## è·å–å¸®åŠ©

å¦‚é‡é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ `UPGRADE_GUIDE.md` äº†è§£è¯¦ç»†ä¿¡æ¯
2. æ£€æŸ¥ç»ˆç«¯é”™è¯¯æ—¥å¿—
3. æŸ¥çœ‹æµè§ˆå™¨å¼€å‘è€…æ§åˆ¶å°
4. å‚è€ƒé¡¹ç›®æ³¨é‡Šå’Œä»£ç æ–‡æ¡£

---

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰
